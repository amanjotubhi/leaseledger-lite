<div class="dashboard-container">
  <!-- Summary Cards -->
  <section class="summary-section" [class.visible]="cardsVisible">
    <div 
      class="summary-card" 
      *ngFor="let card of [
        { icon: 'ðŸ’°', label: 'Total Charges', value: formatCurrency(totalCharges), class: 'revenue', delay: 0 },
        { icon: 'ðŸ’³', label: 'Total Payments', value: formatCurrency(totalPayments), class: 'payments', delay: 1 },
        { icon: totalBalance > 0 ? 'âš ï¸' : 'âœ…', label: 'Net Balance', value: formatCurrency(totalBalance), class: 'balance', negative: totalBalance > 0, delay: 2 },
        { icon: 'â°', label: 'Overdue Accounts', value: overdueCount, subvalue: formatCurrency(totalAging) + ' total', class: 'overdue', delay: 3 }
      ]; let i = index"
      [style.animation-delay]="card.delay + '00ms'"
      [class.negative]="card.negative">
      <div class="card-icon" [ngClass]="card.class">
        <span>{{ card.icon }}</span>
      </div>
      <div class="card-content">
        <h3 class="card-label">{{ card.label }}</h3>
        <p class="card-value" [class.negative]="card.negative">
          {{ card.value }}
        </p>
        <p class="card-subvalue" *ngIf="card.subvalue">{{ card.subvalue }}</p>
      </div>
      <div class="card-glow"></div>
    </div>
  </section>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-overlay">
    <div class="apple-spinner">
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
      <div class="spinner-ring"></div>
    </div>
    <p class="loading-text">Loading your data...</p>
  </div>

  <!-- Rent Roll Section -->
  <section 
    class="report-section" 
    [class.visible]="tablesVisible && !loading"
    style="animation-delay: 400ms">
    <div class="section-header">
      <div class="section-title-group">
        <div class="section-icon-wrapper">
          <span class="section-icon">ðŸ“‹</span>
        </div>
        <div>
          <h2 class="section-title">Rent Roll Report</h2>
          <p class="section-description">Current month lease activity</p>
        </div>
      </div>
      <span class="section-badge">
        <span class="badge-dot"></span>
        {{ rent.length }} Active Leases
      </span>
    </div>
    
    <div class="table-container">
      <div class="table-scroll">
        <table class="data-table">
          <thead>
            <tr>
              <th>Lease ID</th>
              <th>Tenant Name</th>
              <th>Unit #</th>
              <th class="text-right">Monthly Charges</th>
              <th class="text-right">Monthly Payments</th>
              <th class="text-right">Balance</th>
            </tr>
          </thead>
          <tbody>
            <tr 
              *ngFor="let r of rent; let i = index" 
              [class.even-row]="i % 2 === 0"
              [style.animation-delay]="(i * 30) + 'ms'">
              <td class="lease-id">
                <span class="id-badge">#{{ r.lease_id }}</span>
              </td>
              <td class="tenant-name">
                <div class="tenant-avatar">{{ r.tenant_name.charAt(0) }}</div>
                <span>{{ r.tenant_name }}</span>
              </td>
              <td class="unit-no">{{ r.unit_no }}</td>
              <td class="text-right amount">{{ r.monthly_charges }}</td>
              <td class="text-right amount">{{ r.monthly_payments }}</td>
              <td class="text-right amount" [ngClass]="getBalanceClass(r.month_balance)">
                {{ r.month_balance }}
              </td>
            </tr>
            <tr *ngIf="rent.length === 0 && !loading" class="empty-row">
              <td colspan="6" class="empty-message">
                <span class="empty-icon">ðŸ“­</span>
                <p>No rent roll data available</p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- A/R Aging Section -->
  <section 
    class="report-section" 
    [class.visible]="tablesVisible && !loading"
    style="animation-delay: 500ms">
    <div class="section-header">
      <div class="section-title-group">
        <div class="section-icon-wrapper">
          <span class="section-icon">ðŸ“Š</span>
        </div>
        <div>
          <h2 class="section-title">Accounts Receivable Aging</h2>
          <p class="section-description">Outstanding receivables by aging bucket</p>
        </div>
      </div>
      <span class="section-badge">
        <span class="badge-dot"></span>
        {{ aging.length }} Accounts
      </span>
    </div>
    
    <div class="table-container">
      <div class="table-scroll">
        <table class="data-table">
          <thead>
            <tr>
              <th>Lease ID</th>
              <th>Tenant Name</th>
              <th>Unit #</th>
              <th class="text-right aging-bucket">0-30 Days</th>
              <th class="text-right aging-bucket">31-60 Days</th>
              <th class="text-right aging-bucket">61-90 Days</th>
              <th class="text-right aging-bucket">90+ Days</th>
              <th class="text-right total-due">Total Due</th>
            </tr>
          </thead>
          <tbody>
            <tr 
              *ngFor="let a of aging; let i = index" 
              [class.even-row]="i % 2 === 0"
              [style.animation-delay]="(i * 30) + 'ms'">
              <td class="lease-id">
                <span class="id-badge">#{{ a.lease_id }}</span>
              </td>
              <td class="tenant-name">
                <div class="tenant-avatar">{{ a.tenant_name.charAt(0) }}</div>
                <span>{{ a.tenant_name }}</span>
              </td>
              <td class="unit-no">{{ a.unit_no }}</td>
              <td class="text-right amount" [ngClass]="getAgingClass(a.bucket_0_30)">
                {{ a.bucket_0_30 }}
              </td>
              <td class="text-right amount" [ngClass]="getAgingClass(a.bucket_31_60)">
                {{ a.bucket_31_60 }}
              </td>
              <td class="text-right amount" [ngClass]="getAgingClass(a.bucket_61_90)">
                {{ a.bucket_61_90 }}
              </td>
              <td class="text-right amount overdue-high" [ngClass]="getAgingClass(a.bucket_90_plus)">
                {{ a.bucket_90_plus }}
              </td>
              <td class="text-right amount total-due" [ngClass]="getAgingClass(a.total_due)">
                <span class="total-badge">{{ a.total_due }}</span>
              </td>
            </tr>
            <tr *ngIf="aging.length === 0 && !loading" class="empty-row">
              <td colspan="8" class="empty-message">
                <span class="empty-icon">ðŸ“­</span>
                <p>No aging data available</p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>
</div>

